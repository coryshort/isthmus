#!/bin/bash
OPENSIM_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )/.." && pwd )"
TARGET_DIR="runtime"

if [ $# -eq 0 ]; then
    echo "Usage: $0 <opensim_distribution.zip>"
    exit 0
fi

if [ ! -x `which unzip` ]; then
    echo "Package 'unzip' needs to be installed"
    exit 0
fi

EXCLUDE="bin/config-include/* bin/Regions/* bin/OpenSim.ini bin/OpenSim.exe.config bin/OpenSim32.exe.config"
cd "${OPENSIM_DIR}"
unzip -q -o -d "${TARGET_DIR}" "$1" -x ${EXCLUDE} &>/dev/null

echo "After minor upgrades: issue ./simauto restart"
echo "Database migrations, script API changes and other major upgrades: ./simauto stop && ./simtool clearscripts && ./simauto start"


#!/bin/bash
OPENSIM_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )/.." && pwd )"

declare GRIDS
for GRID in ${OPENSIM_DIR}/share/grids/* ; do
    GRIDS=("${GRIDS[@]}" "`basename \"${GRID}\"`")
done

if [ $# -eq 0 ]; then
    echo "Usage: ${0} gridname"
    echo "Available grids are: ${GRIDS[@]}"
    exit 0
fi

GRID=${1}

if [ ! -d "${OPENSIM_DIR}/share/grids/${GRID}" ]; then
    echo "Error: No such grid"
    echo "Available grids are: ${GRIDS[@]}"
    exit 0
fi

echo "Installing files needed for ${GRID}"
cp -r "${OPENSIM_DIR}/share/grids/${GRID}/." "${OPENSIM_DIR}"

echo "Installing common files"
cp -r "${OPENSIM_DIR}/share/common/." "${OPENSIM_DIR}"

echo "Protecting passwords"
chmod 600 "${OPENSIM_DIR}/etc/database.ini"
chmod 600 "${OPENSIM_DIR}/etc/Gloebit.ini"
chmod 600 "${OPENSIM_DIR}/etc/voice.ini"

echo "Done"
